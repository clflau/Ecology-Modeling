# 1 files combined:
# 	C:\Users\Tharsis\Documents\GitHub\PyRate-master\PyRate-master\example_files\pyrate_mcmc_logs/Ursidae_1_G_marginal_rates.log
# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)
pdf(file='~/GitHub/PyRate-master/PyRate-master/example_files/pyrate_mcmc_logs/Ursidae_1_G_marginal_rates_RTT.pdf',width=0.6*9, height=0.6*21)
par(mfrow=c(3,1))
library(scales)
L_hpd_m95=c(0.149, 0.149,0.15,0.149,0.149,0.15,0.15,0.146,0.143,0.138,0.131,0.131,0.128,0.128,0.128,0.127,0.128,0.126,0.123,0.09,0.102,0.168)
L_hpd_M95=c(0.325, 0.325,0.325,0.325,0.323,0.321,0.319,0.311,0.306,0.297,0.29,0.289,0.286,0.284,0.284,0.284,0.286,0.286,0.29,0.35,1.087,1.746)
M_hpd_m95=c(0.164, 0.164,0.178,0.179,0.174,0.16,0.156,0.149,0.133,0.115,0.113,0.112,0.113,0.112,0.115,0.116,0.117,0.117,0.116,0.116,0.114,0.116)
M_hpd_M95=c(0.58, 0.58,0.469,0.468,0.462,0.452,0.448,0.442,0.421,0.367,0.333,0.317,0.313,0.309,0.311,0.309,0.309,0.309,0.309,0.309,0.311,0.337)
R_hpd_m95=c(-0.371, -0.371,-0.274,-0.269,-0.26,-0.249,-0.237,-0.232,-0.21,-0.176,-0.147,-0.136,-0.134,-0.127,-0.127,-0.125,-0.125,-0.127,-0.137,-0.188,-0.175,-0.07)
R_hpd_M95=c(0.167, 0.167,0.091,0.091,0.091,0.099,0.106,0.106,0.113,0.114,0.113,0.113,0.113,0.113,0.113,0.113,0.113,0.113,0.113,0.185,0.884,1.562)
L_mean=c(0.228, 0.228,0.229,0.229,0.228,0.227,0.226,0.224,0.219,0.215,0.212,0.21,0.209,0.209,0.209,0.208,0.209,0.21,0.212,0.23,0.402,1.003)
M_mean=c(0.332, 0.332,0.302,0.297,0.287,0.28,0.272,0.264,0.249,0.23,0.22,0.216,0.215,0.214,0.214,0.214,0.214,0.215,0.214,0.215,0.215,0.227)
R_mean=c(-0.104, -0.104,-0.073,-0.068,-0.059,-0.052,-0.046,-0.04,-0.031,-0.015,-0.008,-0.006,-0.005,-0.005,-0.006,-0.006,-0.005,-0.005,-0.002,0.016,0.187,0.776)
trans=0.5
age=(0:(22-1))* -1
plot(age,age,type = 'n', ylim = c(0, 1.9206), xlim = c(-23.1,1.1), ylab = 'Speciation rate', xlab = 'Ma',main='Ursidae' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 0.638), xlim = c(-23.1,1.1), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-0.4081, 1.7182), xlim = c(-23.1,1.1), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
n <- dev.off()
par(mfrow=c(3,1))
library(scales)
L_hpd_m95=c(0.149, 0.149,0.15,0.149,0.149,0.15,0.15,0.146,0.143,0.138,0.131,0.131,0.128,0.128,0.128,0.127,0.128,0.126,0.123,0.09,0.102,0.168)
L_hpd_M95=c(0.325, 0.325,0.325,0.325,0.323,0.321,0.319,0.311,0.306,0.297,0.29,0.289,0.286,0.284,0.284,0.284,0.286,0.286,0.29,0.35,1.087,1.746)
M_hpd_m95=c(0.164, 0.164,0.178,0.179,0.174,0.16,0.156,0.149,0.133,0.115,0.113,0.112,0.113,0.112,0.115,0.116,0.117,0.117,0.116,0.116,0.114,0.116)
M_hpd_M95=c(0.58, 0.58,0.469,0.468,0.462,0.452,0.448,0.442,0.421,0.367,0.333,0.317,0.313,0.309,0.311,0.309,0.309,0.309,0.309,0.309,0.311,0.337)
R_hpd_m95=c(-0.371, -0.371,-0.274,-0.269,-0.26,-0.249,-0.237,-0.232,-0.21,-0.176,-0.147,-0.136,-0.134,-0.127,-0.127,-0.125,-0.125,-0.127,-0.137,-0.188,-0.175,-0.07)
R_hpd_M95=c(0.167, 0.167,0.091,0.091,0.091,0.099,0.106,0.106,0.113,0.114,0.113,0.113,0.113,0.113,0.113,0.113,0.113,0.113,0.113,0.185,0.884,1.562)
L_mean=c(0.228, 0.228,0.229,0.229,0.228,0.227,0.226,0.224,0.219,0.215,0.212,0.21,0.209,0.209,0.209,0.208,0.209,0.21,0.212,0.23,0.402,1.003)
M_mean=c(0.332, 0.332,0.302,0.297,0.287,0.28,0.272,0.264,0.249,0.23,0.22,0.216,0.215,0.214,0.214,0.214,0.214,0.215,0.214,0.215,0.215,0.227)
R_mean=c(-0.104, -0.104,-0.073,-0.068,-0.059,-0.052,-0.046,-0.04,-0.031,-0.015,-0.008,-0.006,-0.005,-0.005,-0.006,-0.006,-0.005,-0.005,-0.002,0.016,0.187,0.776)
trans=0.5
age=(0:(22-1))* -1
plot(age,age,type = 'n', ylim = c(0, 1.9206), xlim = c(-23.1,1.1), ylab = 'Speciation rate', xlab = 'Ma',main='Ursidae' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 0.638), xlim = c(-23.1,1.1), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-0.4081, 1.7182), xlim = c(-23.1,1.1), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
par(mfrow=c(1,1))
library(scales)
L_hpd_m95=c(0.149, 0.149,0.15,0.149,0.149,0.15,0.15,0.146,0.143,0.138,0.131,0.131,0.128,0.128,0.128,0.127,0.128,0.126,0.123,0.09,0.102,0.168)
L_hpd_M95=c(0.325, 0.325,0.325,0.325,0.323,0.321,0.319,0.311,0.306,0.297,0.29,0.289,0.286,0.284,0.284,0.284,0.286,0.286,0.29,0.35,1.087,1.746)
M_hpd_m95=c(0.164, 0.164,0.178,0.179,0.174,0.16,0.156,0.149,0.133,0.115,0.113,0.112,0.113,0.112,0.115,0.116,0.117,0.117,0.116,0.116,0.114,0.116)
M_hpd_M95=c(0.58, 0.58,0.469,0.468,0.462,0.452,0.448,0.442,0.421,0.367,0.333,0.317,0.313,0.309,0.311,0.309,0.309,0.309,0.309,0.309,0.311,0.337)
R_hpd_m95=c(-0.371, -0.371,-0.274,-0.269,-0.26,-0.249,-0.237,-0.232,-0.21,-0.176,-0.147,-0.136,-0.134,-0.127,-0.127,-0.125,-0.125,-0.127,-0.137,-0.188,-0.175,-0.07)
R_hpd_M95=c(0.167, 0.167,0.091,0.091,0.091,0.099,0.106,0.106,0.113,0.114,0.113,0.113,0.113,0.113,0.113,0.113,0.113,0.113,0.113,0.185,0.884,1.562)
L_mean=c(0.228, 0.228,0.229,0.229,0.228,0.227,0.226,0.224,0.219,0.215,0.212,0.21,0.209,0.209,0.209,0.208,0.209,0.21,0.212,0.23,0.402,1.003)
M_mean=c(0.332, 0.332,0.302,0.297,0.287,0.28,0.272,0.264,0.249,0.23,0.22,0.216,0.215,0.214,0.214,0.214,0.214,0.215,0.214,0.215,0.215,0.227)
R_mean=c(-0.104, -0.104,-0.073,-0.068,-0.059,-0.052,-0.046,-0.04,-0.031,-0.015,-0.008,-0.006,-0.005,-0.005,-0.006,-0.006,-0.005,-0.005,-0.002,0.016,0.187,0.776)
trans=0.5
age=(0:(22-1))* -1
plot(age,age,type = 'n', ylim = c(0, 1.9206), xlim = c(-23.1,1.1), ylab = 'Speciation rate', xlab = 'Ma',main='Ursidae' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
NN <- RR*(1-KK/N0)
RR <- 1
KK <- 2
N0 <- 3
NN <- RR*(1-KK/N0)
NN
NN <- RR(1-KK/N0)
c(5)
RR <- 1
KK <- 2
N0 <- 3
NN <- RR*(1-KK/N0)
NN <- RR*(1-(KK/N0))
NN
NN <- RR*(1-KK/N0)
NN
wombat_LM <- rbind(c(0.6, 1.5), c(0.3, 0)) #Leslie matrix
wombat_LM
wombat_LM^2
wombat_LM%^%2
AA <- NULL
for (ii in 1:2067-2015){
AA <- wombat_LM%*%wombat_LM
}
wombat_LM
AA
n_2067 <- AA %*% n_2015
n_2015 <- matrix(c(2000, 1000), nrow = 2, byrow = TRUE)
n_2067 <- AA %*% n_2015
n_2067
wombat_LM %*% wombat_LM
AA
AA <- wombat_LM
for (ii in 1:2067-2015){
AA <- wombat_LM %*% AA
}
AA
n_2067 <- AA %*% n_2015
n_2067
AA <- wombat_LM
AA
for (ii in 1:2016-2015){
AA <- wombat_LM %*% AA
}
AA
AA <- wombat_LM
n_2015 <- matrix(c(2000, 1000), nrow = 2, byrow = TRUE)
AA <- wombat_LM
for (ii in 1:2016-2015){
AA <- wombat_LM %*% AA
}
AA
n_2067 <- AA %*% n_2015
n_2067
AA <- wombat_LM
AA
tt <- 2016-2015
for (ii in tt){
AA <- wombat_LM %*% AA
}
AA
tt <- 2067-2015
for (ii in tt){
AA <- wombat_LM %*% AA
}
AA
n_2067 <- AA %*% n_2015
n_2067
AA <- wombat_LM
tt <- 2067-2015
for (ii in tt){
AA <- wombat_LM %*% AA
}
n_2067 <- AA %*% n_2015
n_2067
tt <- 2068-2015
for (ii in tt){
AA <- wombat_LM %*% AA
}
n_2068 <- AA %*% n_2015
n_2068
sum(n_2068)/sum(n_2067)
tt <- 2069-2015
for (ii in tt){
AA <- wombat_LM %*% AA
}
n_2069 <- AA %*% n_2015
sum(n_2069)/sum(n_2068)
AA <- wombat_LM
tt <- 2067-2015
for (ii in 1:tt){
AA <- wombat_LM %*% AA
}
n_2067 <- AA %*% n_2015
n_2067
tt <- 2068-2015
for (ii in 1:tt){
AA <- wombat_LM %*% AA
}
n_2068 <- AA %*% n_2015
n_2068
sum(n_2068)/sum(n_2067)
tt <- 2069-2015
for (ii in 1:tt){
AA <- wombat_LM %*% AA
}
n_2069 <- AA %*% n_2015
sum(n_2069)/sum(n_2068)
n_2069
AA
setwd("~/GitHub/Ecology Modeling")
library(deSolve)
S_0 <- 1e-4
D <- (6.0e-2)/3600
y1 <- 2.5e10
K_S1 <- 3.0e-6
mu1 <- 0.81/3600
r1 <- 0.75/3600
J1 <- 2.4e-7
y2 <- 3.8e10
K_S2 <- 3.1e-4
mu2 <- 0.91/3600
r2 <- 0.85/3600
J2 <- 2.19e-5
parameters <- c(S_0=S_0, D=D, y1=y1, K_S1=K_S1, mu1=mu1, r1=r1, J1=J1, y2=y2, K_S2=K_S2, mu2=mu2, r2=r2, J2=J2)
NutriODE <- function(tt, init, parameters) {
SS <- init[1]
N1 <- init[2]
N2 <- init[3]
with(as.list(parameters), {
dS.dt <- (S_0-SS)*D - mu1*SS*N1/(y1*(K_S1+SS)) - mu2*SS*N2/(y2*(K_S2+SS))
dN1.dt <- mu1*SS*N1/(K_S1+SS) - D*N1
dN2.dt <- mu2*SS*N2/(K_S2+SS) - D*N2
return(list(c(dS.dt, dN1.dt, dN2.dt)))})
}
init <- c(SS=S_0, N1=1e3, N2=200*1e3)
tseq <- seq(0, 120*3600)
exper1.out <- lsoda( init, tseq, NutriODE, parameters)
plot(exper1.out[,1]/3600, log(exper1.out[,3])/200, col="blue", type="l", ylim = c(0.03, 0.08), xaxt = "n", xlab = "Time(hours)", ylab = "Log cells/ml")
lines(exper1.out[,1]/3600, log(exper1.out[,4])/200, col="red", type="l", lty = 2)
axis(side = 1, at = seq(0, length(exper1.out[,1])/3600, by=10))
legend(20, 0.05, c("C-8", "PAO"), col = c("blue", "red"), lty = c(1, 2))
lines(exper1.out[,1]/3600, log(exper1.out[,4])/200, col="red", type="l", lty = 3)
